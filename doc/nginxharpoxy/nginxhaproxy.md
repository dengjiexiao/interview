## 负载均衡器
## 问题
1. [nginx是什么，有什么特点?](#1)
2. [haproxy是什么，有什么特点?](#2)
3. [nginx 与 haproxy的区别是什么](#3)
---
## 答案
---
1. <span id = "1"> nginx是什么，有什么特点?</span>  
Nginx是一款轻量级的Web服务器/反向代理服务器以及电子邮件代理服务器,特点是占有内存小，并发能力强，在Linux操作系统下，nginx使用epoll事件模型，得益于此，nginx操作效率高。  
用途：将防火墙后面的服务器提供给Internet用户访问。反向代理还可以为后端的多台服务器提供负载平衡或为后端较慢的服务器提供缓冲服务。
其中代理方式分为正向代理和反向代理。   
**正向代理**：是一个位于客户端A和原始服务器（服务器B）之间的服务器（代理服务器Z），为了从原始服务器取得内容，用户A向代理服务器Z发送一个请求并指定目标（服务器B），然后代理服务器Z向服务器B转交请求并将获得的内容返回给客户端。客户端必须要进行一些特别的设置才能使用正向代理   
用途：在防火墙内的局域网客户端提供访问Internet的途径。还可以使用缓冲特性减少网络使用率。
**反向代理**： 客户端（用户A）向反向代理的命名空间（name-space）中的内容发送普通请求，接着反向代理将判断向何处（原始服务器）转交请求，并将获得的内容返回给客户端。而客户端始终认为它访问的是原始服务器B而不是服务器Z。由于防火墙作用，只允许服务器Z进出，防火墙和反向代理共同作用保护了院子资源服务器B。      
用途：将防火墙后面的服务器提供给Internet用户访问。反向代理还可以为后端的多台服务器提供负载平衡或为后端较慢的服务器提供缓冲服务。     
**Nginx优势：**  
1、作为Web服务器，Nginx处理静态文件、索引文件，自动索引的效率非常高  
2、作为代理服务器，Nginx可以实现无缓存的反向代理加速，提高网站运行速度    
3、作为负载均衡服务器，Nginx既可以在内部直接支持Rails和PHP，也可以支持HTTP代理服务器对外进行服务，同时还支持简单的容错和利用算法进行负载均衡  
4、在性能方面，Nginx是专门为性能优化而开发的，实现上非常注重效率。它采用内核Poll模型，可以支持更多的并发连接，最大可以支持对5万个并发连接数的响应，而且只占用很低的内存资源   
5、在稳定性方面，Nginx采取了分阶段资源分配技术，使得CPU与内存的占用率非常低。Nginx官方表示，Nginx保持1万个没有活动的连接，而这些连接只占用2.5MB内存，因此，类似DOS这样的攻击对Nginx来说基本上是没有任何作用的   
6、在高可用性方面，Nginx支持热部署，启动速度特别迅速，因此可以在不间断服务的情况下，对软件版本或者配置进行升级，即使运行数月也无需重新启动，几乎可以做到7x24小时不间断地运行   
Nginx具有很高的稳定性；支持热部署；代码质量非常高，代码很规范，手法成熟，模块扩
----
2. <span id = "2"> haproxy是什么，有什么特点？</span>   
**HAProxy**是一个C语言编写的开源负载软件，提供高可以用性、负载君和以及基于TCP和HTTP的应用程序代理软件。
**HAproxy的特点：**    
(1)、HAProxy也是支持虚拟主机   
(2)、HAProxy支持Session的保持、Cookie的引导；同时支持通过获取指定的url来检测后端服务器的状态。   
(3)、单纯从效率上来讲HAProxy会比Nginx有更出色的负载均衡速度，在并发处理上也是优于Nginx的    
(4)、HAProxy支持TCP协议的负载均衡转发，可以对MySQL进行负载均衡，对后端的MySQL节点进行检测和负载均衡    
(5)、HAProxy负载均衡策略非常多，HAProxy的负载均衡算法现在具体有如下8种：     
① roundrobin，表示简单的轮询，这个不多说，这个是负载均衡基本都具备的；    
② static-rr，表示根据权；     
③ leastconn，表示最少连接者先处理；   
④ source，表示根据请求源IP，这个跟Nginx的IP_hash机制类似，我们用其作为解决session问题的一种方法；   
⑤ ri，表示根据请求的URI；    
⑥ rl_param，表示根据请求的URl参数’balance url_param’ requires an URL parameter name；    
⑦ hdr(name)，表示根据HTTP请求头来锁定每一次HTTP请求；    
⑧ rdp-cookie(name)，表示根据据cookie(name)来锁定并哈希每一次TCP请求。
-----
3. <span id ="3"> nginx 与 haproxy的区别是什么?</span>    
**Nginx:**    
优点：web服务器为主，结构性好，支持模块扩展，有反向代理模型。   
缺点：支持负载均衡算法少，不支持健康检查，没有提供远程获取信息功能。   
**HAProxy:**   
优点：主要功能是负载均衡，负载均衡算法支持很多，支持健康检查，支持各占会话保持方式，支持远程管理；   
缺点：扩展性查，添加新功能需要重新编译相应模块；重新加载配置文件需要结束进程，远不如nginx的reload平滑加载。
